(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/res_detail/res_detail"],{"07e0":function(e,t,n){"use strict";n.r(t);var r=n("2ef8"),o=n("8ed1");for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("0f2a");var a,s=n("f0c5"),u=Object(s["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);t["default"]=u.exports},"0f2a":function(e,t,n){"use strict";var r=n("7d7a"),o=n.n(r);o.a},"2ef8":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.resStartTime.getFullYear()),r=("0"+(e.resStartTime.getMonth()+1)).slice(-2),o=("0"+e.resStartTime.getDate()).slice(-2),i=("0"+e.resStartTime.getHours()).slice(-2),a=("0"+e.resStartTime.getMinutes()).slice(-2),s=e.resEndTime.getFullYear(),u=("0"+(e.resEndTime.getMonth()+1)).slice(-2),c=("0"+e.resEndTime.getDate()).slice(-2),l=("0"+e.resEndTime.getHours()).slice(-2),d=("0"+e.resEndTime.getMinutes()).slice(-2);e._isMounted||(e.e0=function(t){e.press=!0},e.e1=function(t){e.press=!1}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:r,g2:o,g3:i,g4:a,g5:s,g6:u,g7:c,g8:l,g9:d}})},i=[]},"73c6":function(e,t,n){"use strict";(function(e){n("6f72");r(n("66fd"));var t=r(n("07e0"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"7d7a":function(e,t,n){},8310:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("6bed"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function a(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(){n.e("components/t-navbar2").then(function(){return resolve(n("4f8d"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("components/t-dialog").then(function(){return resolve(n("4b8a"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("components/t-action-sheet").then(function(){return resolve(n("67af"))}.bind(null,n)).catch(n.oe)},d=(requirePlugin("routePlan"),{name:"res_detail",components:{tNavbar2:u,tDialog:c,tActionSheet:l},onLoad:function(e){switch(this.reqPath="/"+e.restype+"/detail/"+e.detid.replace(/\"/g,""),this.putMemberPath="/"+e.restype+"/detail/"+e.detid.replace(/\"/g,"")+"/members",e.restype){case"learning":this.navTitle="学习局";break;case"sport":this.navTitle="运动局";break;case"amuse":this.navTitle="娱乐局";break;default:this.navTitle="局子"}},onShow:function(){var t=this,n=e.getStorageSync("res_data");this.title=n.title,this.loca_text=n.loca_text,this.person_num=n.person_num,this.res_starttime=n.res_starttime,this.res_endtime=n.res_endtime,this.loading=!1;var o=e.getStorageSync("openid");o&&(this.userOpenid=o),r.default.getCloud(this.reqPath).then((function(e){var n=e.data[0];t.ownerOpenid=n.owner.openid,t.ownerName=n.owner.name,t.ownerAvatar=n.owner.avatar,t.ownerPhoneNumber=n.owner.phone_number,t.ownerWxid=n.owner.wxid,t.resMembers=n.members,t.loca_latitude=n.loca_geo.coordinates[1],t.loca_longitude=n.loca_geo.coordinates[0],t.remarks=n.remarks,t.userOpenid==n.owner.openid&&(t.hadNotJoinIn=!1)})).catch((function(e){}));var i=e.getStorageSync("userInfo");i&&(this.hadLogin=!0,this.userAvatar=i.avatarUrl,this.userNickName=i.nickName)},computed:{resStartTime:function(){return new Date(this.res_starttime)},resEndTime:function(){return new Date(this.res_endtime)}},watch:{resMembers:function(e,t){var n,r=i(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.openid==this.userOpenid&&(this.hadNotJoinIn=!1)}}catch(a){r.e(a)}finally{r.f()}}},data:function(){return{navBarHeight:getApp().globalData.navBarHeight,loading:!0,navTitle:"学习局",press:!1,dialogShow:!1,reqPath:"",putMemberPath:"",title:"",loca_text:"",loca_latitude:0,loca_longitude:0,res_starttime:"",res_endtime:"",person_num:2,ownerOpenid:"",ownerName:" ",ownerAvatar:"../../static/profile/avatar.jpg",ownerPhoneNumber:"",ownerWxid:"",resMembers:[],remarks:"无",hadLogin:!1,hadNotJoinIn:!0,actionSheetShow:!1,userOpenid:"",userAvatar:"",userNickName:"",userPhoneNum:"",userName:"",setASheetBottom:0,setASheetPadBot:0}},methods:{removeMe:function(){},phoneNumInput:function(e){this.userPhoneNum=e.detail.value},confirmJoin:function(){var t=this,n=this.checkPhoneNum(this.userPhoneNum);if(""==n)if(void 0!=this.userAvatar&&void 0!=this.userNickName){t.actionSheetShow=!1,e.showLoading({title:"正在入局"});var o={push:[{avatar:this.userAvatar,nickName:this.userNickName,openid:this.userOpenid,phone_number:this.userPhoneNum}]};r.default.putCloud(this.putMemberPath,o).then((function(t){1==t.data.updated&&(e.hideLoading(),e.showToast({title:"加入成功",duration:1300,position:"bottom",icon:"none"}))})).catch((function(e){})),setTimeout((function(){r.default.getCloud(t.reqPath).then((function(e){var n=e.data[0],r=n.members;t.resMembers.length=0;for(var o=0;o<r.length;o++)t.resMembers.push(r[o])}))}),3e3)}else this.dialogShow=!0;else e.showToast({title:n,duration:2e3,position:"bottom",icon:"none"})},checkPhoneNum:function(e){function t(e){return e.replace(/\s+/g,"")}var n=/^1[3-9]\d{9}$/,r="";return""===t(e)?(r="请输入手机号码",r):(n.test(e)||(r="手机号码格式错误"),r)},cancelLogin:function(){this.dialogShow=!1},confirmLogin:function(){var t=this,n=this;this.dialogShow=!1,wx.getUserProfile({desc:"用于发布信息",success:function(t){e.showLoading({title:"登陆中"}),e.setStorage({key:"userInfo",data:t.userInfo,success:function(){n.hadLogin=!0,n.userAvatar=t.userInfo.avatarUrl,n.userNickName=t.userInfo.nickName;var o=e.getStorageSync("openid");o&&r.default.postCloud("/wxuser/openid/"+o,t.userInfo).then((function(t){e.hideLoading(),e.showToast({title:"登陆成功，请再次点击加入",duration:2e3,position:"bottom",icon:"none"})}))}})},fail:function(e){t.hadLogin=!1}})},closeActionSheet:function(e){this.actionSheetShow=e},joinRes:function(){if(!this.hadLogin)return this.dialogShow=!0;this.actionSheetShow=!0},makePhoneCall:function(){var t=this;e.makePhoneCall({phoneNumber:t.ownerPhoneNumber})},useMap:function(){var e="L6WBZ-SLZRO-RPOWQ-S4VCD-XB2MJ-4CB2O",t="lichees-mp",n=JSON.stringify({name:this.loca_text,latitude:this.loca_latitude,longitude:this.loca_longitude});wx.navigateTo({url:"plugin://routePlan/index?key="+e+"&referer="+t+"&endPoint="+n})}}});t.default=d}).call(this,n("543d")["default"])},"8ed1":function(e,t,n){"use strict";n.r(t);var r=n("8310"),o=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a}},[["73c6","common/runtime","common/vendor"]]]);